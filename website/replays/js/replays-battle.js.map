{"version":3,"file":"replays-battle.js","names":["showAd","id","window","top","__vm_add","success","document","readyState","addEventListener","placement","createElement","setAttribute","innerWidth","querySelector","appendChild","push","BattleDiv","_preact$Component","_inheritsLoose","apply","arguments","_proto","prototype","shouldComponentUpdate","render","preact","h","style","position","Component","BattleLogDiv","_preact$Component2","_proto2","BattlePanel","_preact$Component3","_this","_len","length","args","Array","_key","call","concat","result","undefined","battle","speed","lastUsedKeyCode","turnView","autofocusTurnView","keyPressed","e","_e$target","_e$target2","_this$battle","_this$battle2","keyCode","ctrlKey","metaKey","altKey","closeTurn","target","tagName","atQueueEnd","replay","paused","play","pause","shiftKey","firstTurn","prevTurn","lastTurn","nextTurn","stepSpeed","alert","String","fromCharCode","preventDefault","forceUpdate","toggleMute","_this$battle3","_this$battle4","_this$battle5","reset","_this$battle6","_this$battle7","seekBy","_this$battle8","_this$battle9","seekTurn","_this$battle10","Infinity","goToTurn","_this$base","_this$battle11","turn","base","value","trim","turnNum","Number","isNaN","switchViewpoint","_this$battle12","_this$battle13","viewpointSwitched","PSRouter","replace","stripQuery","props","clickDownload","_this$result","filename","tier","timestamp","uploadtime","date","Date","getFullYear","getMonth","getDate","toID","p1","name","p2","a","currentTarget","href","BattleLog","createReplayFileHref","download","stopPropagation","changeSpeed","fadeTable","hyperfast","fast","normal","slow","reallyslow","delayTable","messageShownTime","messageFadeTime","scene","updateAcceleration","changeSound","_this$battle14","muted","setMute","openTurn","_this$battle15","_proto3","componentDidMount","loadBattle","onkeydown","componentWillReceiveProps","nextProps","includes","slice","indexOf","_this2","destroy","Net","get","then","JSON","parse","$base","$","Battle","$frame","find","$logFrame","log","split","isReplay","autoresize","subscribe","_","query","decodeQuery","t","parseInt","componentWillUnmount","_this$battle16","componentDidUpdate","_this$base2","select","_this$base3","turnbox","setSelectionRange","focus","delta","_this$base4","values","newValue","_this$battle17","BattleSound","renderNotFound","showingLeft","maxWidth","textAlign","src","alt","imageRendering","renderControls","_this$battle18","_this$battle19","_this$result2","_this$result3","atEnd","atStart","started","onSubmit","autofocus","inputMode","size","type","onClick","width","marginRight","disabled","marginLeft","zIndex","onChange","format","toDateString","rating","stickyRight","bottom"],"sources":["../src/replays-battle.tsx"],"sourcesContent":["/** @jsx preact.h */\nimport preact from 'preact';\nimport $ from 'jquery';\nimport {Net} from './utils';\nimport {PSRouter} from './replays';\nimport {Battle} from '../../../src/battle';\nimport {BattleLog} from '../../../src/battle-log';\nimport {BattleSound} from '../../../src/battle-sound';\ndeclare function toID(input: string): string;\n\nfunction showAd(id: string) {\n  // @ts-expect-error\n  window.top.__vm_add = window.top.__vm_add || [];\n\n  //this is a x-browser way to make sure content has loaded.\n\n  (function (success) {\n    if (window.document.readyState !== \"loading\") {\n      success();\n    } else {\n      window.document.addEventListener(\"DOMContentLoaded\", function () {\n        success();\n      });\n    }\n  })(function () {\n    var placement = document.createElement(\"div\");\n    placement.setAttribute(\"class\", \"vm-placement\");\n    if (window.innerWidth > 1000) {\n      //load desktop placement\n      placement.setAttribute(\"data-id\", \"6452680c0b35755a3f09b59b\");\n    } else {\n      //load mobile placement\n      placement.setAttribute(\"data-id\", \"645268557bc7b571c2f06f62\");\n    }\n    document.querySelector(\"#\" + id)!.appendChild(placement);\n    // @ts-expect-error\n    window.top.__vm_add.push(placement);\n  });\n}\n\nexport class BattleDiv extends preact.Component {\n\toverride shouldComponentUpdate() {\n\t\treturn false;\n\t}\n\toverride render() {\n\t\treturn <div class=\"battle\" style={{position: 'relative'}}></div>;\n\t}\n}\nclass BattleLogDiv extends preact.Component {\n\toverride shouldComponentUpdate() {\n\t\treturn false;\n\t}\n\toverride render() {\n\t\treturn <div class=\"battle-log\"></div>;\n\t}\n}\n\nexport class BattlePanel extends preact.Component<{id: string}> {\n  result: {\n    uploadtime: number;\n    id: string;\n    format: string;\n    p1: string;\n    p2: string;\n    log: string;\n    views: number;\n    p1id: string;\n    p2id: string;\n    rating: number;\n    private: number;\n    password: string;\n  } | null | undefined = undefined;\n  battle: Battle | null;\n  speed = 'normal';\n  /** debug purposes */\n  lastUsedKeyCode = '0';\n  turnView: boolean | string = false;\n  autofocusTurnView: 'select' | 'end' | null = null;\n  override componentDidMount() {\n    this.loadBattle(this.props.id);\n    showAd('LeaderboardBTF');\n    window.onkeydown = this.keyPressed;\n  }\n  override componentWillReceiveProps(nextProps) {\n    if (this.stripQuery(this.props.id) !== this.stripQuery(nextProps.id)) {\n      this.loadBattle(nextProps.id);\n    }\n  }\n  stripQuery(id: string) {\n    return id.includes('?') ? id.slice(0, id.indexOf('?')) : id;\n  }\n  loadBattle(id: string) {\n    if (this.battle) this.battle.destroy();\n    this.battle = null;\n    this.result = undefined;\n\n    Net(`https://replay.pokemonshowdown.com/${this.stripQuery(id)}.json`).get().then(result => {\n      const replay: NonNullable<BattlePanel['result']> = JSON.parse(result);\n      this.result = replay;\n      const $base = $(this.base!);\n      this.battle = new Battle({\n        id: replay.id,\n        $frame: $base.find('.battle'),\n        $logFrame: $base.find('.battle-log'),\n        log: replay.log.split('\\n'),\n        isReplay: true,\n        paused: true,\n        autoresize: true,\n      });\n      // for ease of debugging\n      (window as any).battle = this.battle;\n      this.battle.subscribe(_ => {\n        this.forceUpdate();\n      });\n      const query = Net.decodeQuery(id);\n      if ('p2' in query) {\n        this.battle.switchViewpoint();\n      }\n      if (query.turn || query.t) {\n        this.battle.seekTurn(parseInt(query.turn || query.t, 10));\n      }\n      this.forceUpdate();\n    }).catch(_ => {\n      this.result = null;\n      this.forceUpdate();\n    });\n  }\n  override componentWillUnmount(): void {\n    this.battle?.destroy();\n    (window as any).battle = null;\n    window.onkeydown = null;\n  }\n  override componentDidUpdate(): void {\n    if (this.autofocusTurnView === 'select') {\n      this.base?.querySelector<HTMLInputElement>('input[name=turn]')?.select();\n      this.autofocusTurnView = null;\n    }\n    if (this.autofocusTurnView === 'end') {\n      const turnbox = this.base?.querySelector<HTMLInputElement>('input[name=turn]');\n      turnbox?.setSelectionRange(2, 2);\n      turnbox?.focus();\n      this.autofocusTurnView = null;\n    }\n  }\n  keyPressed = (e: KeyboardEvent) => {\n    // @ts-ignore\n    this.lastUsedKeyCode = `${e.keyCode}`;\n    if (e.ctrlKey || e.metaKey || e.altKey) return;\n    if (e.keyCode === 27 && this.turnView) { // Esc\n      this.closeTurn();\n      return;\n    }\n    // @ts-ignore\n    if (e.target?.tagName === 'INPUT' || e.target?.tagName === 'SELECT') return;\n    switch (e.keyCode) {\n    case 75: // k\n      if (this.battle?.atQueueEnd) {\n        this.replay();\n      } else if (this.battle?.paused) {\n        this.play();\n      } else {\n        this.pause();\n      }\n      break;\n    case 74: // j\n      if (e.shiftKey) this.firstTurn();\n      else this.prevTurn();\n      break;\n    case 76: // l\n      if (e.shiftKey) this.lastTurn();\n      else this.nextTurn();\n      break;\n    case 188: // , (<)\n      if (e.shiftKey) this.stepSpeed(-1);\n      break;\n    case 190: // . (>)\n      if (e.shiftKey) this.stepSpeed(1);\n      break;\n    case 191: // / (?)\n      if (e.shiftKey) {\n        alert(\n          'k = play/pause\\n' +\n          'j = previous turn\\n' +\n          'l = next turn\\n' +\n          'J = first turn\\n' +\n          'L = last turn\\n' +\n          'm = mute\\n' +\n          '< = slower\\n' +\n          '> = faster\\n' +\n          '1-9 = skip to turn\\n' +\n          '? = keyboard shortcuts (this)\\n'\n        );\n      }\n      break;\n    case 48: case 49: case 50: case 51: case 52: case 53: case 54: case 55: case 56: case 57: // 0-9\n    case 96: case 97: case 98: case 99: case 100: case 101: case 102: case 103: case 104: case 105: // numpad 0-9\n      this.turnView = String.fromCharCode(e.keyCode - (e.keyCode >= 96 ? 48 : 0));\n      if (this.turnView === '0') this.turnView = '10';\n      this.autofocusTurnView = 'end';\n      e.preventDefault();\n      this.forceUpdate();\n      break;\n    case 77: // m\n      this.toggleMute();\n      break;\n    }\n    this.forceUpdate();\n  };\n  play = () => {\n    this.battle?.play();\n  };\n  replay = () => {\n    this.battle?.reset();\n    this.battle?.play();\n    this.forceUpdate();\n  };\n  pause = () => {\n    this.battle?.pause();\n  };\n  nextTurn = () => {\n    this.battle?.seekBy(1);\n  };\n  prevTurn = () => {\n    this.battle?.seekBy(-1);\n  };\n  firstTurn = () => {\n    this.battle?.seekTurn(0);\n  };\n  lastTurn = () => {\n    this.battle?.seekTurn(Infinity);\n  };\n  goToTurn = (e) => {\n\t\tconst turn = this.base?.querySelector<HTMLInputElement>('input[name=turn]')?.value;\n\t\tif (!turn?.trim()) return this.closeTurn(e);\n\t\tlet turnNum = Number(turn);\n\t\tif (turn === 'e' || turn === 'end' || turn === 'f' || turn === 'finish') turnNum = Infinity;\n\t\tif (isNaN(turnNum) || turnNum < 0) alert(\"Invalid turn\");\n\t\tthis.battle?.seekTurn(turnNum);\n    this.closeTurn(e);\n  };\n  switchViewpoint = () => {\n    this.battle?.switchViewpoint();\n    if (this.battle?.viewpointSwitched) {\n      PSRouter.replace(this.stripQuery(this.props.id) + '?p2');\n    } else {\n      PSRouter.replace(this.stripQuery(this.props.id));\n    }\n  };\n\tclickDownload = (e: MouseEvent) => {\n    if (!this.battle) {\n      // should never happen\n      alert(\"Wait for the battle to finish loading before downloading.\");\n      return;\n    }\n\t\tlet filename = (this.battle.tier || 'Battle').replace(/[^A-Za-z0-9]/g, '');\n\n\t\t// ladies and gentlemen, JavaScript dates\n\t\tconst timestamp = (this.result?.uploadtime || 0) * 1000;\n\t\tconst date = new Date(timestamp);\n\t\tfilename += '-' + date.getFullYear();\n\t\tfilename += (date.getMonth() >= 9 ? '-' : '-0') + (date.getMonth() + 1);\n\t\tfilename += (date.getDate() >= 10 ? '-' : '-0') + date.getDate();\n\n\t\tfilename += '-' + toID(this.battle.p1.name);\n\t\tfilename += '-' + toID(this.battle.p2.name);\n\n    const a = e.currentTarget as HTMLAnchorElement;\n\t\ta.href = BattleLog.createReplayFileHref({battle: this.battle});\n\t\ta.download = filename + '.html';\n\n\t\te.stopPropagation();\n\t};\n  changeSpeed = (e: Event | {target: HTMLSelectElement}) => {\n    this.speed = (e.target as HTMLSelectElement).value;\n    const fadeTable = {\n      hyperfast: 40,\n      fast: 50,\n      normal: 300,\n      slow: 500,\n      reallyslow: 1000\n    };\n    const delayTable = {\n      hyperfast: 1,\n      fast: 1,\n      normal: 1,\n      slow: 1000,\n      reallyslow: 3000\n    };\n    if (!this.battle) return;\n    this.battle.messageShownTime = delayTable[this.speed];\n    this.battle.messageFadeTime = fadeTable[this.speed];\n    this.battle.scene.updateAcceleration();\n  };\n  stepSpeed(delta: number) {\n    const target = this.base?.querySelector<HTMLSelectElement>('select[name=speed]');\n    if (!target) return; // should never happen\n    const values = ['reallyslow', 'slow', 'normal', 'fast', 'hyperfast'];\n    const newValue = values[values.indexOf(target.value) + delta];\n    if (newValue) {\n      target.value = newValue;\n      this.changeSpeed({target});\n    }\n  }\n  toggleMute() {\n    this.battle?.setMute(!BattleSound.muted);\n    this.forceUpdate();\n  }\n  changeSound = (e: Event) => {\n    const muted = (e.target as HTMLSelectElement).value;\n    this.battle?.setMute(muted === 'off');\n  };\n  openTurn = (e: Event) => {\n    this.turnView = `${this.battle?.turn}` || true;\n    this.autofocusTurnView = 'select';\n    e.preventDefault();\n    this.forceUpdate();\n  };\n  closeTurn = (e?: Event) => {\n    this.turnView = false;\n    e?.preventDefault();\n    this.forceUpdate();\n  };\n  renderNotFound() {\n    return <div class={PSRouter.showingLeft() ? 'mainbar has-sidebar' : 'mainbar'}><section class=\"section\" style={{maxWidth: '200px'}}>\n      {/* <div style={{margin: '0 -20px'}}>\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-n.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-o.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-t.png\" alt=\"\" width={120} height={120} />\n      </div>\n      <div style={{margin: '-40px -20px 0'}}>\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-f.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-o.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-u.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-n.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-d.png\" alt=\"\" width={120} height={120} />\n      </div> */}\n      <div style={{textAlign: 'center'}}>\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-n.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-o.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-t.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n      </div>\n      <div style={{textAlign: 'center'}}>\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-f.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-o.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-u.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-n.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-d.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\n      </div>\n    </section><section class=\"section\">\n\t\t\t<h1>Not Found</h1>\n\t\t\t<p>\n\t\t\t\tThe battle you're looking for has expired. Battles expire after 15 minutes of inactivity unless they're saved.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tIn the future, remember to click <strong>Upload and share replay</strong> to save a replay permanently.\n\t\t\t</p>\n    </section></div>;\n  }\n  renderControls() {\n    const atEnd = !this.battle || this.battle.atQueueEnd;\n    const atStart = !this.battle?.started;\n\n    if (this.turnView) {\n      const value = this.turnView === true ? undefined : this.turnView;\n      this.turnView = true;\n      return <div class=\"replay-controls\"><section class=\"section\">\n        <form onSubmit={this.goToTurn}>\n          Turn? <input name=\"turn\" autofocus value={value} inputMode=\"numeric\" class=\"textbox\" size={5} /> {}\n          <button type=\"submit\" class=\"button\"><strong>Go</strong></button> {}\n          <button type=\"button\" class=\"button\" onClick={this.closeTurn}>Cancel</button>\n        </form>\n        <p>\n          <em>Pro tip:</em> You don't need to click \"Skip to turn\" if you have a keyboard, just start typing the turn number and press <kbd>Enter</kbd>. For more shortcuts, press <kbd>Shift</kbd>+<kbd>/</kbd> when a text box isn't focused.\n        </p>\n      </section></div>;\n    }\n\n    return <div class=\"replay-controls\">\n      <p>\n        {atEnd && this.battle ?\n          <button onClick={this.replay} class=\"button\" style={{width: '5em', marginRight: '3px'}}>\n            <i class=\"fa fa-undo\"></i><br />Replay\n          </button>\n        : (!this.battle || this.battle.paused) ?\n          <button onClick={this.play} class=\"button\" disabled={!this.battle} style={{width: '5em', marginRight: '3px'}}>\n            <i class=\"fa fa-play\"></i><br /><strong>Play</strong>\n          </button>\n        :\n          <button onClick={this.pause} class=\"button\" style={{width: '5em', marginRight: '3px'}}>\n            <i class=\"fa fa-pause\"></i><br /><strong>Pause</strong>\n          </button>\n        } {}\n        <button class=\"button button-first\" disabled={atStart} onClick={this.firstTurn}>\n          <i class=\"fa fa-fast-backward\"></i><br />First turn\n        </button>\n        <button class=\"button button-first\" disabled={atStart} style={{marginLeft:'1px',position:'relative',zIndex:'1'}} onClick={this.prevTurn}>\n          <i class=\"fa fa-step-backward\"></i><br />Prev turn\n        </button>\n        <button class=\"button button-last\" disabled={atEnd} style={{marginRight:'2px'}} onClick={this.nextTurn}>\n          <i class=\"fa fa-step-forward\"></i><br />Skip turn\n        </button>\n        <button class=\"button button-last\" disabled={atEnd} onClick={this.lastTurn}>\n          <i class=\"fa fa-fast-forward\"></i><br />Skip to end\n        </button> {}\n        <button class=\"button\" onClick={this.openTurn}>\n          <i class=\"fa fa-repeat\"></i> Go to turn...\n        </button>\n      </p>\n      <p>\n        <label class=\"optgroup\">\n          Speed:<br />\n          <select name=\"speed\" class=\"button\" onChange={this.changeSpeed} value={this.speed}>\n            <option value=\"hyperfast\">Hyperfast</option>\n            <option value=\"fast\">Fast</option>\n            <option value=\"normal\">Normal</option>\n            <option value=\"slow\">Slow</option>\n            <option value=\"reallyslow\">Really slow</option>\n          </select>\n        </label> {}\n        <label class=\"optgroup\">\n          Sound:<br />\n          <select name=\"speed\" class=\"button\" onChange={this.changeSound} value={BattleSound.muted ? 'off' : 'on'}>\n            <option value=\"on\">On</option>\n            <option value=\"off\">Muted</option>\n          </select>\n        </label> {}\n        <label class=\"optgroup\">\n          Viewpoint:<br />\n          <button onClick={this.switchViewpoint} class={this.battle ? 'button' : 'button disabled'}>\n            {(this.battle?.viewpointSwitched ? this.result?.p2 : this.result?.p1 || \"Player\")} {}\n            <i class=\"fa fa-random\" aria-label=\"Switch viewpoint\"></i>\n          </button>\n        </label>\n      </p>\n      {this.result ? <h1>\n        <strong>{this.result.format}</strong>: {this.result.p1} vs. {this.result.p2}\n      </h1> : <h1>\n        <em>Loading...</em>\n      </h1>}\n      {this.result ? <p>\n        <a class=\"button\" href=\"#\" onClick={this.clickDownload} style={{float: 'right'}}>\n          <i class=\"fa fa-download\" aria-hidden></i> Download\n        </a>\n        {this.result.uploadtime ? new Date(this.result.uploadtime * 1000).toDateString() : \"Unknown upload date\"}\n        {this.result.rating ? [` | `, <em>Rating:</em>, ` ${this.result.rating}`] : ''}\n        {/* {} <code>{this.keyCode}</code> */}\n      </p> : <p>&nbsp;</p>}\n      {!PSRouter.showingLeft() && <p>\n        <a href=\".\" class=\"button\"><i class=\"fa fa-caret-left\"></i> More replays</a>\n      </p>}\n    </div>;\n  }\n  override render() {\n    if (this.result === null) return this.renderNotFound();\n\n    let position: any = {};\n    if (PSRouter.showingLeft()) {\n      if (PSRouter.stickyRight) {\n        position = {position: 'sticky', top: '0'};\n      } else {\n        position = {position: 'sticky', bottom: '0'};\n      }\n    }\n\n    return <div class={PSRouter.showingLeft() ? 'mainbar has-sidebar' : 'mainbar'} style={position}><div style={{position: 'relative'}}>\n      <BattleDiv />\n      <BattleLogDiv />\n      {this.renderControls()}\n      <div id=\"LeaderboardBTF\"></div>\n    </div></div>;\n  }\n}\n"],"mappings":";;;;;;;;;;AAUA,QAAS,CAAAA,MAAMA,CAACC,EAAU,CAAE;;AAE1BC,MAAM,CAACC,GAAG,CAACC,QAAQ,CAAGF,MAAM,CAACC,GAAG,CAACC,QAAQ,EAAI,EAAE;;;;AAI/C,CAAC,SAAUC,OAAO,CAAE;AAClB,GAAIH,MAAM,CAACI,QAAQ,CAACC,UAAU,GAAK,SAAS,CAAE;AAC5CF,OAAO,CAAC,CAAC;AACX,CAAC,IAAM;AACLH,MAAM,CAACI,QAAQ,CAACE,gBAAgB,CAAC,kBAAkB,CAAE,UAAY;AAC/DH,OAAO,CAAC,CAAC;AACX,CAAC,CAAC;AACJ;AACF,CAAC,EAAE,UAAY;AACb,GAAI,CAAAI,SAAS,CAAGH,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;AAC7CD,SAAS,CAACE,YAAY,CAAC,OAAO,CAAE,cAAc,CAAC;AAC/C,GAAIT,MAAM,CAACU,UAAU,CAAG,IAAI,CAAE;;AAE5BH,SAAS,CAACE,YAAY,CAAC,SAAS,CAAE,0BAA0B,CAAC;AAC/D,CAAC,IAAM;;AAELF,SAAS,CAACE,YAAY,CAAC,SAAS,CAAE,0BAA0B,CAAC;AAC/D;AACAL,QAAQ,CAACO,aAAa,CAAC,GAAG,CAAGZ,EAAE,CAAC,CAAEa,WAAW,CAACL,SAAS,CAAC;;AAExDP,MAAM,CAACC,GAAG,CAACC,QAAQ,CAACW,IAAI,CAACN,SAAS,CAAC;AACrC,CAAC,CAAC;AACJ,CAAC;;AAEYO,SAAS,UAAAC,iBAAA,EAAAC,cAAA,CAAAF,SAAA,CAAAC,iBAAA,WAAAD,UAAA,SAAAC,iBAAA,CAAAE,KAAA,MAAAC,SAAA,aAAAC,MAAA,CAAAL,SAAA,CAAAM,SAAA,CAAAD,MAAA;AACZE,qBAAqB,CAA9B,SAAAA,sBAAA,CAAiC;AAChC,MAAO,MAAK;AACb,CAAC,CAAAF,MAAA;AACQG,MAAM,CAAf,SAAAA,OAAA,CAAkB;AACjB,MAAO,CAAAC,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,CAACC,KAAK,CAAE,CAACC,QAAQ,CAAE,UAAU,CAAE,CAAM,CAAC;AACjE,CAAC,QAAAZ,SAAA,GAN6BS,MAAM,CAACI,SAAS;;AAQzCC,YAAY,UAAAC,kBAAA,EAAAb,cAAA,CAAAY,YAAA,CAAAC,kBAAA,WAAAD,aAAA,SAAAC,kBAAA,CAAAZ,KAAA,MAAAC,SAAA,aAAAY,OAAA,CAAAF,YAAA,CAAAR,SAAA,CAAAU,OAAA;AACRT,qBAAqB,CAA9B,SAAAA,sBAAA,CAAiC;AAChC,MAAO,MAAK;AACb,CAAC,CAAAS,OAAA;AACQR,MAAM,CAAf,SAAAA,OAAA,CAAkB;AACjB,MAAO,CAAAC,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,CAAM,CAAC;AACtC,CAAC,QAAAI,YAAA,GANyBL,MAAM,CAACI,SAAS;;;AAS9BI,WAAW,UAAAC,kBAAA,EAAAhB,cAAA,CAAAe,WAAA,CAAAC,kBAAA,WAAAD,YAAA,MAAAE,KAAA,SAAAC,IAAA,CAAAhB,SAAA,CAAAiB,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAAH,IAAA,EAAAI,IAAA,GAAAA,IAAA,CAAAJ,IAAA,CAAAI,IAAA,IAAAF,IAAA,CAAAE,IAAA,EAAApB,SAAA,CAAAoB,IAAA,GAAAL,KAAA,CAAAD,kBAAA,CAAAO,IAAA,CAAAtB,KAAA,CAAAe,kBAAA,QAAAQ,MAAA,CAAAJ,IAAA,SAAAH,KAAA;AACtBQ,MAAM;;;;;;;;;;;;;AAaiBC,SAAS,CAAAT,KAAA;AAChCU,MAAM,QAAAV,KAAA;AACNW,KAAK,CAAG,QAAQ,CAAAX,KAAA;;AAEhBY,eAAe,CAAG,GAAG,CAAAZ,KAAA;AACrBa,QAAQ,CAAqB,KAAK,CAAAb,KAAA;AAClCc,iBAAiB,CAA4B,IAAI,CAAAd,KAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEjDe,UAAU,CAAG,SAACC,CAAgB,CAAK,KAAAC,SAAA,CAAAC,UAAA,CAAAC,YAAA,CAAAC,aAAA;;AAEjCpB,KAAA,CAAKY,eAAe,IAAMI,CAAC,CAACK,OAAS;AACrC,GAAIL,CAAC,CAACM,OAAO,EAAIN,CAAC,CAACO,OAAO,EAAIP,CAAC,CAACQ,MAAM,CAAE;AACxC,GAAIR,CAAC,CAACK,OAAO,GAAK,EAAE,EAAIrB,KAAA,CAAKa,QAAQ,CAAE;AACrCb,KAAA,CAAKyB,SAAS,CAAC,CAAC;AAChB;AACF;;AAEA,GAAI,EAAAR,SAAA,CAAAD,CAAC,CAACU,MAAM,eAART,SAAA,CAAUU,OAAO,IAAK,OAAO,EAAI,EAAAT,UAAA,CAAAF,CAAC,CAACU,MAAM,eAARR,UAAA,CAAUS,OAAO,IAAK,QAAQ,CAAE;AACrE,OAAQX,CAAC,CAACK,OAAO;AACjB,IAAK,GAAE;AACL,IAAAF,YAAA,CAAInB,KAAA,CAAKU,MAAM,SAAXS,YAAA,CAAaS,UAAU,CAAE;AAC3B5B,KAAA,CAAK6B,MAAM,CAAC,CAAC;AACf,CAAC,IAAM,KAAAT,aAAA,CAAIpB,KAAA,CAAKU,MAAM,SAAXU,aAAA,CAAaU,MAAM,CAAE;AAC9B9B,KAAA,CAAK+B,IAAI,CAAC,CAAC;AACb,CAAC,IAAM;AACL/B,KAAA,CAAKgC,KAAK,CAAC,CAAC;AACd;AACA;AACF,IAAK,GAAE;AACL,GAAIhB,CAAC,CAACiB,QAAQ,CAAEjC,KAAA,CAAKkC,SAAS,CAAC,CAAC,CAAC;AAC5BlC,KAAA,CAAKmC,QAAQ,CAAC,CAAC;AACpB;AACF,IAAK,GAAE;AACL,GAAInB,CAAC,CAACiB,QAAQ,CAAEjC,KAAA,CAAKoC,QAAQ,CAAC,CAAC,CAAC;AAC3BpC,KAAA,CAAKqC,QAAQ,CAAC,CAAC;AACpB;AACF,IAAK,IAAG;AACN,GAAIrB,CAAC,CAACiB,QAAQ,CAAEjC,KAAA,CAAKsC,SAAS,CAAC,CAAC,CAAC,CAAC;AAClC;AACF,IAAK,IAAG;AACN,GAAItB,CAAC,CAACiB,QAAQ,CAAEjC,KAAA,CAAKsC,SAAS,CAAC,CAAC,CAAC;AACjC;AACF,IAAK,IAAG;AACN,GAAItB,CAAC,CAACiB,QAAQ,CAAE;AACdM,KAAK;AACH,kBAAkB;AAClB,qBAAqB;AACrB,iBAAiB;AACjB,kBAAkB;AAClB,iBAAiB;AACjB,YAAY;AACZ,cAAc;AACd,cAAc;AACd,sBAAsB;AACtB;AACF,CAAC;AACH;AACA;AACF,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE;AACxF,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,GAAE,CAAE,IAAK,IAAG,CAAE,IAAK,IAAG,CAAE,IAAK,IAAG,CAAE,IAAK,IAAG,CAAE,IAAK,IAAG,CAAE,IAAK,IAAG;AAC5FvC,KAAA,CAAKa,QAAQ,CAAG2B,MAAM,CAACC,YAAY,CAACzB,CAAC,CAACK,OAAO,EAAIL,CAAC,CAACK,OAAO,EAAI,EAAE,CAAG,EAAE,CAAG,CAAC,CAAC,CAAC;AAC3E,GAAIrB,KAAA,CAAKa,QAAQ,GAAK,GAAG,CAAEb,KAAA,CAAKa,QAAQ,CAAG,IAAI;AAC/Cb,KAAA,CAAKc,iBAAiB,CAAG,KAAK;AAC9BE,CAAC,CAAC0B,cAAc,CAAC,CAAC;AAClB1C,KAAA,CAAK2C,WAAW,CAAC,CAAC;AAClB;AACF,IAAK,GAAE;AACL3C,KAAA,CAAK4C,UAAU,CAAC,CAAC;AACjB;AACF;AACA5C,KAAA,CAAK2C,WAAW,CAAC,CAAC;AACpB,CAAC,CAAA3C,KAAA;AACD+B,IAAI,CAAG,UAAM,KAAAc,aAAA;AACX,CAAAA,aAAA,CAAA7C,KAAA,CAAKU,MAAM,SAAXmC,aAAA,CAAad,IAAI,CAAC,CAAC;AACrB,CAAC,CAAA/B,KAAA;AACD6B,MAAM,CAAG,UAAM,KAAAiB,aAAA,CAAAC,aAAA;AACb,CAAAD,aAAA,CAAA9C,KAAA,CAAKU,MAAM,SAAXoC,aAAA,CAAaE,KAAK,CAAC,CAAC;AACpB,CAAAD,aAAA,CAAA/C,KAAA,CAAKU,MAAM,SAAXqC,aAAA,CAAahB,IAAI,CAAC,CAAC;AACnB/B,KAAA,CAAK2C,WAAW,CAAC,CAAC;AACpB,CAAC,CAAA3C,KAAA;AACDgC,KAAK,CAAG,UAAM,KAAAiB,aAAA;AACZ,CAAAA,aAAA,CAAAjD,KAAA,CAAKU,MAAM,SAAXuC,aAAA,CAAajB,KAAK,CAAC,CAAC;AACtB,CAAC,CAAAhC,KAAA;AACDqC,QAAQ,CAAG,UAAM,KAAAa,aAAA;AACf,CAAAA,aAAA,CAAAlD,KAAA,CAAKU,MAAM,SAAXwC,aAAA,CAAaC,MAAM,CAAC,CAAC,CAAC;AACxB,CAAC,CAAAnD,KAAA;AACDmC,QAAQ,CAAG,UAAM,KAAAiB,aAAA;AACf,CAAAA,aAAA,CAAApD,KAAA,CAAKU,MAAM,SAAX0C,aAAA,CAAaD,MAAM,CAAC,CAAC,CAAC,CAAC;AACzB,CAAC,CAAAnD,KAAA;AACDkC,SAAS,CAAG,UAAM,KAAAmB,aAAA;AAChB,CAAAA,aAAA,CAAArD,KAAA,CAAKU,MAAM,SAAX2C,aAAA,CAAaC,QAAQ,CAAC,CAAC,CAAC;AAC1B,CAAC,CAAAtD,KAAA;AACDoC,QAAQ,CAAG,UAAM,KAAAmB,cAAA;AACf,CAAAA,cAAA,CAAAvD,KAAA,CAAKU,MAAM,SAAX6C,cAAA,CAAaD,QAAQ,CAACE,QAAQ,CAAC;AACjC,CAAC,CAAAxD,KAAA;AACDyD,QAAQ,CAAG,SAACzC,CAAC,CAAK,KAAA0C,UAAA,CAAAC,cAAA;AAClB,GAAM,CAAAC,IAAI,EAAAF,UAAA,CAAG1D,KAAA,CAAK6D,IAAI,UAAAH,UAAA,CAATA,UAAA,CAAWhF,aAAa,CAAmB,kBAAkB,CAAC,eAA9DgF,UAAA,CAAgEI,KAAK;AAClF,GAAI,EAACF,IAAI,QAAJA,IAAI,CAAEG,IAAI,CAAC,CAAC,EAAE,MAAO,CAAA/D,KAAA,CAAKyB,SAAS,CAACT,CAAC,CAAC;AAC3C,GAAI,CAAAgD,OAAO,CAAGC,MAAM,CAACL,IAAI,CAAC;AAC1B,GAAIA,IAAI,GAAK,GAAG,EAAIA,IAAI,GAAK,KAAK,EAAIA,IAAI,GAAK,GAAG,EAAIA,IAAI,GAAK,QAAQ,CAAEI,OAAO,CAAGR,QAAQ;AAC3F,GAAIU,KAAK,CAACF,OAAO,CAAC,EAAIA,OAAO,CAAG,CAAC,CAAEzB,KAAK,CAAC,cAAc,CAAC;AACxD,CAAAoB,cAAA,CAAA3D,KAAA,CAAKU,MAAM,SAAXiD,cAAA,CAAaL,QAAQ,CAACU,OAAO,CAAC;AAC5BhE,KAAA,CAAKyB,SAAS,CAACT,CAAC,CAAC;AACnB,CAAC,CAAAhB,KAAA;AACDmE,eAAe,CAAG,UAAM,KAAAC,cAAA,CAAAC,cAAA;AACtB,CAAAD,cAAA,CAAApE,KAAA,CAAKU,MAAM,SAAX0D,cAAA,CAAaD,eAAe,CAAC,CAAC;AAC9B,IAAAE,cAAA,CAAIrE,KAAA,CAAKU,MAAM,SAAX2D,cAAA,CAAaC,iBAAiB,CAAE;AAClCC,QAAQ,CAACC,OAAO,CAACxE,KAAA,CAAKyE,UAAU,CAACzE,KAAA,CAAK0E,KAAK,CAAC5G,EAAE,CAAC,CAAG,KAAK,CAAC;AAC1D,CAAC,IAAM;AACLyG,QAAQ,CAACC,OAAO,CAACxE,KAAA,CAAKyE,UAAU,CAACzE,KAAA,CAAK0E,KAAK,CAAC5G,EAAE,CAAC,CAAC;AAClD;AACF,CAAC,CAAAkC,KAAA;AACF2E,aAAa,CAAG,SAAC3D,CAAa,CAAK,KAAA4D,YAAA;AAChC,GAAI,CAAC5E,KAAA,CAAKU,MAAM,CAAE;;AAEhB6B,KAAK,CAAC,2DAA2D,CAAC;AAClE;AACF;AACF,GAAI,CAAAsC,QAAQ,CAAG,CAAC7E,KAAA,CAAKU,MAAM,CAACoE,IAAI,EAAI,QAAQ,EAAEN,OAAO,CAAC,eAAe,CAAE,EAAE,CAAC;;;AAG1E,GAAM,CAAAO,SAAS,CAAG,CAAC,EAAAH,YAAA,CAAA5E,KAAA,CAAKQ,MAAM,eAAXoE,YAAA,CAAaI,UAAU,GAAI,CAAC,EAAI,IAAI;AACvD,GAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAACH,SAAS,CAAC;AAChCF,QAAQ,EAAI,GAAG,CAAGI,IAAI,CAACE,WAAW,CAAC,CAAC;AACpCN,QAAQ,EAAI,CAACI,IAAI,CAACG,QAAQ,CAAC,CAAC,EAAI,CAAC,CAAG,GAAG,CAAG,IAAI,GAAKH,IAAI,CAACG,QAAQ,CAAC,CAAC,CAAG,CAAC,CAAC;AACvEP,QAAQ,EAAI,CAACI,IAAI,CAACI,OAAO,CAAC,CAAC,EAAI,EAAE,CAAG,GAAG,CAAG,IAAI,EAAIJ,IAAI,CAACI,OAAO,CAAC,CAAC;;AAEhER,QAAQ,EAAI,GAAG,CAAGS,IAAI,CAACtF,KAAA,CAAKU,MAAM,CAAC6E,EAAE,CAACC,IAAI,CAAC;AAC3CX,QAAQ,EAAI,GAAG,CAAGS,IAAI,CAACtF,KAAA,CAAKU,MAAM,CAAC+E,EAAE,CAACD,IAAI,CAAC;;AAEzC,GAAM,CAAAE,CAAC,CAAG1E,CAAC,CAAC2E,aAAkC;AAChDD,CAAC,CAACE,IAAI,CAAGC,SAAS,CAACC,oBAAoB,CAAC,CAACpF,MAAM,CAAEV,KAAA,CAAKU,MAAM,CAAC,CAAC;AAC9DgF,CAAC,CAACK,QAAQ,CAAGlB,QAAQ,CAAG,OAAO;;AAE/B7D,CAAC,CAACgF,eAAe,CAAC,CAAC;AACpB,CAAC,CAAAhG,KAAA;AACAiG,WAAW,CAAG,SAACjF,CAAsC,CAAK;AACxDhB,KAAA,CAAKW,KAAK,CAAIK,CAAC,CAACU,MAAM,CAAuBoC,KAAK;AAClD,GAAM,CAAAoC,SAAS,CAAG;AAChBC,SAAS,CAAE,EAAE;AACbC,IAAI,CAAE,EAAE;AACRC,MAAM,CAAE,GAAG;AACXC,IAAI,CAAE,GAAG;AACTC,UAAU,CAAE;AACd,CAAC;AACD,GAAM,CAAAC,UAAU,CAAG;AACjBL,SAAS,CAAE,CAAC;AACZC,IAAI,CAAE,CAAC;AACPC,MAAM,CAAE,CAAC;AACTC,IAAI,CAAE,IAAI;AACVC,UAAU,CAAE;AACd,CAAC;AACD,GAAI,CAACvG,KAAA,CAAKU,MAAM,CAAE;AAClBV,KAAA,CAAKU,MAAM,CAAC+F,gBAAgB,CAAGD,UAAU,CAACxG,KAAA,CAAKW,KAAK,CAAC;AACrDX,KAAA,CAAKU,MAAM,CAACgG,eAAe,CAAGR,SAAS,CAAClG,KAAA,CAAKW,KAAK,CAAC;AACnDX,KAAA,CAAKU,MAAM,CAACiG,KAAK,CAACC,kBAAkB,CAAC,CAAC;AACxC,CAAC,CAAA5G,KAAA;;;;;;;;;;;;;;;AAeD6G,WAAW,CAAG,SAAC7F,CAAQ,CAAK,KAAA8F,cAAA;AAC1B,GAAM,CAAAC,KAAK,CAAI/F,CAAC,CAACU,MAAM,CAAuBoC,KAAK;AACnD,CAAAgD,cAAA,CAAA9G,KAAA,CAAKU,MAAM,SAAXoG,cAAA,CAAaE,OAAO,CAACD,KAAK,GAAK,KAAK,CAAC;AACvC,CAAC,CAAA/G,KAAA;AACDiH,QAAQ,CAAG,SAACjG,CAAQ,CAAK,KAAAkG,cAAA;AACvBlH,KAAA,CAAKa,QAAQ,CAAG,KAAAqG,cAAA,CAAGlH,KAAA,CAAKU,MAAM,eAAXwG,cAAA,CAAatD,IAAI,GAAM,IAAI;AAC9C5D,KAAA,CAAKc,iBAAiB,CAAG,QAAQ;AACjCE,CAAC,CAAC0B,cAAc,CAAC,CAAC;AAClB1C,KAAA,CAAK2C,WAAW,CAAC,CAAC;AACpB,CAAC,CAAA3C,KAAA;AACDyB,SAAS,CAAG,SAACT,CAAS,CAAK;AACzBhB,KAAA,CAAKa,QAAQ,CAAG,KAAK;AACrBG,CAAC,QAADA,CAAC,CAAE0B,cAAc,CAAC,CAAC;AACnB1C,KAAA,CAAK2C,WAAW,CAAC,CAAC;AACpB,CAAC,QAAA3C,KAAA,MAAAmH,OAAA,CAAArH,WAAA,CAAAX,SAAA,CAAAgI,OAAA,CAnPQC,iBAAiB,CAA1B,SAAAA,kBAAA,CAA6B,CAC3B,IAAI,CAACC,UAAU,CAAC,IAAI,CAAC3C,KAAK,CAAC5G,EAAE,CAAC,CAC9BD,MAAM,CAAC,gBAAgB,CAAC,CACxBE,MAAM,CAACuJ,SAAS,CAAG,IAAI,CAACvG,UAAU,CACpC,CAAC,CAAAoG,OAAA,CACQI,yBAAyB,CAAlC,SAAAA,0BAAmCC,SAAS,CAAE,CAC5C,GAAI,IAAI,CAAC/C,UAAU,CAAC,IAAI,CAACC,KAAK,CAAC5G,EAAE,CAAC,GAAK,IAAI,CAAC2G,UAAU,CAAC+C,SAAS,CAAC1J,EAAE,CAAC,CAAE,CACpE,IAAI,CAACuJ,UAAU,CAACG,SAAS,CAAC1J,EAAE,CAAC,CAC/B,CACF,CAAC,CAAAqJ,OAAA,CACD1C,UAAU,CAAV,SAAAA,WAAW3G,EAAU,CAAE,CACrB,MAAO,CAAAA,EAAE,CAAC2J,QAAQ,CAAC,GAAG,CAAC,CAAG3J,EAAE,CAAC4J,KAAK,CAAC,CAAC,CAAE5J,EAAE,CAAC6J,OAAO,CAAC,GAAG,CAAC,CAAC,CAAG7J,EAAE,CAC7D,CAAC,CAAAqJ,OAAA,CACDE,UAAU,CAAV,SAAAA,WAAWvJ,EAAU,CAAE,KAAA8J,MAAA,MACrB,GAAI,IAAI,CAAClH,MAAM,CAAE,IAAI,CAACA,MAAM,CAACmH,OAAO,CAAC,CAAC,CACtC,IAAI,CAACnH,MAAM,CAAG,IAAI,CAClB,IAAI,CAACF,MAAM,CAAGC,SAAS,CAEvBqH,GAAG,uCAAuC,IAAI,CAACrD,UAAU,CAAC3G,EAAE,CAAC,QAAO,CAAC,CAACiK,GAAG,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAxH,MAAM,CAAI,CACzF,GAAM,CAAAqB,MAA0C,CAAGoG,IAAI,CAACC,KAAK,CAAC1H,MAAM,CAAC,CACrEoH,MAAI,CAACpH,MAAM,CAAGqB,MAAM,CACpB,GAAM,CAAAsG,KAAK,CAAGC,CAAC,CAACR,MAAI,CAAC/D,IAAK,CAAC,CAC3B+D,MAAI,CAAClH,MAAM,CAAG,GAAI,CAAA2H,MAAM,CAAC,CACvBvK,EAAE,CAAE+D,MAAM,CAAC/D,EAAE,CACbwK,MAAM,CAAEH,KAAK,CAACI,IAAI,CAAC,SAAS,CAAC,CAC7BC,SAAS,CAAEL,KAAK,CAACI,IAAI,CAAC,aAAa,CAAC,CACpCE,GAAG,CAAE5G,MAAM,CAAC4G,GAAG,CAACC,KAAK,CAAC,IAAI,CAAC,CAC3BC,QAAQ,CAAE,IAAI,CACd7G,MAAM,CAAE,IAAI,CACZ8G,UAAU,CAAE,IACd,CAAC,CAAC,CAED7K,MAAM,CAAS2C,MAAM,CAAGkH,MAAI,CAAClH,MAAM,CACpCkH,MAAI,CAAClH,MAAM,CAACmI,SAAS,CAAC,SAAAC,CAAC,CAAI,CACzBlB,MAAI,CAACjF,WAAW,CAAC,CAAC,CACpB,CAAC,CAAC,CACF,GAAM,CAAAoG,KAAK,CAAGjB,GAAG,CAACkB,WAAW,CAAClL,EAAE,CAAC,CACjC,GAAI,IAAI,EAAI,CAAAiL,KAAK,CAAE,CACjBnB,MAAI,CAAClH,MAAM,CAACyD,eAAe,CAAC,CAAC,CAC/B,CACA,GAAI4E,KAAK,CAACnF,IAAI,EAAImF,KAAK,CAACE,CAAC,CAAE,CACzBrB,MAAI,CAAClH,MAAM,CAAC4C,QAAQ,CAAC4F,QAAQ,CAACH,KAAK,CAACnF,IAAI,EAAImF,KAAK,CAACE,CAAC,CAAE,EAAE,CAAC,CAAC,CAC3D,CACArB,MAAI,CAACjF,WAAW,CAAC,CAAC,CACpB,CAAC,CAAC,SAAM,CAAC,SAAAmG,CAAC,CAAI,CACZlB,MAAI,CAACpH,MAAM,CAAG,IAAI,CAClBoH,MAAI,CAACjF,WAAW,CAAC,CAAC,CACpB,CAAC,CAAC,CACJ,CAAC,CAAAwE,OAAA,CACQgC,oBAAoB,CAA7B,SAAAA,qBAAA,CAAsC,KAAAC,cAAA,CACpC,CAAAA,cAAA,KAAI,CAAC1I,MAAM,SAAX0I,cAAA,CAAavB,OAAO,CAAC,CAAC,CACrB9J,MAAM,CAAS2C,MAAM,CAAG,IAAI,CAC7B3C,MAAM,CAACuJ,SAAS,CAAG,IAAI,CACzB,CAAC,CAAAH,OAAA,CACQkC,kBAAkB,CAA3B,SAAAA,mBAAA,CAAoC,CAClC,GAAI,IAAI,CAACvI,iBAAiB,GAAK,QAAQ,CAAE,KAAAwI,WAAA,CACvC,CAAAA,WAAA,KAAI,CAACzF,IAAI,UAAAyF,WAAA,CAATA,WAAA,CAAW5K,aAAa,CAAmB,kBAAkB,CAAC,SAA9D4K,WAAA,CAAgEC,MAAM,CAAC,CAAC,CACxE,IAAI,CAACzI,iBAAiB,CAAG,IAAI,CAC/B,CACA,GAAI,IAAI,CAACA,iBAAiB,GAAK,KAAK,CAAE,KAAA0I,WAAA,CACpC,GAAM,CAAAC,OAAO,EAAAD,WAAA,CAAG,IAAI,CAAC3F,IAAI,eAAT2F,WAAA,CAAW9K,aAAa,CAAmB,kBAAkB,CAAC,CAC9E+K,OAAO,QAAPA,OAAO,CAAEC,iBAAiB,CAAC,CAAC,CAAE,CAAC,CAAC,CAChCD,OAAO,QAAPA,OAAO,CAAEE,KAAK,CAAC,CAAC,CAChB,IAAI,CAAC7I,iBAAiB,CAAG,IAAI,CAC/B,CACF,CAAC,CAAAqG,OAAA,CAsJD7E,SAAS,CAAT,SAAAA,UAAUsH,KAAa,CAAE,KAAAC,WAAA,CACvB,GAAM,CAAAnI,MAAM,EAAAmI,WAAA,CAAG,IAAI,CAAChG,IAAI,eAATgG,WAAA,CAAWnL,aAAa,CAAoB,oBAAoB,CAAC,CAChF,GAAI,CAACgD,MAAM,CAAE,OACb,GAAM,CAAAoI,MAAM,CAAG,CAAC,YAAY,CAAE,MAAM,CAAE,QAAQ,CAAE,MAAM,CAAE,WAAW,CAAC,CACpE,GAAM,CAAAC,QAAQ,CAAGD,MAAM,CAACA,MAAM,CAACnC,OAAO,CAACjG,MAAM,CAACoC,KAAK,CAAC,CAAG8F,KAAK,CAAC,CAC7D,GAAIG,QAAQ,CAAE,CACZrI,MAAM,CAACoC,KAAK,CAAGiG,QAAQ,CACvB,IAAI,CAAC9D,WAAW,CAAC,CAACvE,MAAM,CAANA,MAAM,CAAC,CAAC,CAC5B,CACF,CAAC,CAAAyF,OAAA,CACDvE,UAAU,CAAV,SAAAA,WAAA,CAAa,KAAAoH,cAAA,CACX,CAAAA,cAAA,KAAI,CAACtJ,MAAM,SAAXsJ,cAAA,CAAahD,OAAO,CAAC,CAACiD,WAAW,CAAClD,KAAK,CAAC,CACxC,IAAI,CAACpE,WAAW,CAAC,CAAC,CACpB,CAAC,CAAAwE,OAAA;AAgBD+C,cAAc,CAAd,SAAAA,eAAA,CAAiB;AACf,MAAO,CAAA5K,MAAA,CAAAC,CAAA,QAAK,QAAOgF,QAAQ,CAAC4F,WAAW,CAAC,CAAC,CAAG,qBAAqB,CAAG,SAAU,EAAC7K,MAAA,CAAAC,CAAA,YAAS,QAAM,SAAS,CAACC,KAAK,CAAE,CAAC4K,QAAQ,CAAE,OAAO,CAAE;;;;;;;;;;;;;AAajI9K,MAAA,CAAAC,CAAA,QAAKC,KAAK,CAAE,CAAC6K,SAAS,CAAE,QAAQ,CAAE;AAChC/K,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE;AAC7G,CAAC;AACNlL,MAAA,CAAAC,CAAA,QAAKC,KAAK,CAAE,CAAC6K,SAAS,CAAE,QAAQ,CAAE;AAChC/K,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE,CAAC;AACjHlL,MAAA,CAAAC,CAAA,QAAK+K,GAAG,CAAC,wDAAwD,CAACC,GAAG,CAAC,EAAE,CAAC/K,KAAK,CAAE,CAACgL,cAAc,CAAE,WAAW,CAAE,CAAE;AAC7G;AACE,CAAC,CAAAlL,MAAA,CAAAC,CAAA,YAAS,QAAM,SAAS;AACnCD,MAAA,CAAAC,CAAA,WAAI,WAAa,CAAC;AAClBD,MAAA,CAAAC,CAAA,UAAG;;AAEA,CAAC;AACJD,MAAA,CAAAC,CAAA,UAAG,mCAC+B;AAAAD,MAAA,CAAAC,CAAA,eAAQ,yBAA+B,CAAC;AACvE;AACO,CAAM,CAAC;AAClB,CAAC,CAAA4H,OAAA;AACDsD,cAAc,CAAd,SAAAA,eAAA,CAAiB,KAAAC,cAAA,CAAAC,cAAA,CAAAC,aAAA,CAAAC,aAAA;AACf,GAAM,CAAAC,KAAK,CAAG,CAAC,IAAI,CAACpK,MAAM,EAAI,IAAI,CAACA,MAAM,CAACkB,UAAU;AACpD,GAAM,CAAAmJ,OAAO,CAAG,GAAAL,cAAA,CAAC,IAAI,CAAChK,MAAM,SAAXgK,cAAA,CAAaM,OAAO;;AAErC,GAAI,IAAI,CAACnK,QAAQ,CAAE;AACjB,GAAM,CAAAiD,KAAK,CAAG,IAAI,CAACjD,QAAQ,GAAK,IAAI,CAAGJ,SAAS,CAAG,IAAI,CAACI,QAAQ;AAChE,IAAI,CAACA,QAAQ,CAAG,IAAI;AACpB,MAAO,CAAAvB,MAAA,CAAAC,CAAA,QAAK,QAAM,iBAAiB,EAACD,MAAA,CAAAC,CAAA,YAAS,QAAM,SAAS;AAC1DD,MAAA,CAAAC,CAAA,SAAM0L,QAAQ,CAAE,IAAI,CAACxH,QAAS,EAAC,QACvB;AAAAnE,MAAA,CAAAC,CAAA,UAAOiG,IAAI,CAAC,MAAM,CAAC0F,SAAS,MAACpH,KAAK,CAAEA,KAAM,CAACqH,SAAS,CAAC,SAAS,CAAC,QAAM,SAAS,CAACC,IAAI,CAAE,CAAE,CAAE,CAAC,IAAC;AACjG9L,MAAA,CAAAC,CAAA,WAAQ8L,IAAI,CAAC,QAAQ,CAAC,QAAM,QAAQ,EAAC/L,MAAA,CAAAC,CAAA,eAAQ,IAAU,CAAS,CAAC,IAAC;AAClED,MAAA,CAAAC,CAAA,WAAQ8L,IAAI,CAAC,QAAQ,CAAC,QAAM,QAAQ,CAACC,OAAO,CAAE,IAAI,CAAC7J,SAAU,EAAC,QAAc;AACxE,CAAC;AACPnC,MAAA,CAAAC,CAAA;AACED,MAAA,CAAAC,CAAA,WAAI,UAAY,CAAC,iHAA4G,CAAAD,MAAA,CAAAC,CAAA,YAAK,OAAU,CAAC,+BAA4B,CAAAD,MAAA,CAAAC,CAAA,YAAK,OAAU,CAAC,IAAC,CAAAD,MAAA,CAAAC,CAAA,YAAK,GAAM,CAAC;AACrM;AACI,CAAM,CAAC;AAClB;;AAEA,MAAO,CAAAD,MAAA,CAAAC,CAAA,QAAK,QAAM,iBAAiB;AACjCD,MAAA,CAAAC,CAAA;AACGuL,KAAK,EAAI,IAAI,CAACpK,MAAM;AACnBpB,MAAA,CAAAC,CAAA,WAAQ+L,OAAO,CAAE,IAAI,CAACzJ,MAAO,CAAC,QAAM,QAAQ,CAACrC,KAAK,CAAE,CAAC+L,KAAK,CAAE,KAAK,CAAEC,WAAW,CAAE,KAAK,CAAE;AACrFlM,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AAC1B,CAAC;AACR,CAAC,IAAI,CAACmB,MAAM,EAAI,IAAI,CAACA,MAAM,CAACoB,MAAM;AACnCxC,MAAA,CAAAC,CAAA,WAAQ+L,OAAO,CAAE,IAAI,CAACvJ,IAAK,CAAC,QAAM,QAAQ,CAAC0J,QAAQ,CAAE,CAAC,IAAI,CAAC/K,MAAO,CAAClB,KAAK,CAAE,CAAC+L,KAAK,CAAE,KAAK,CAAEC,WAAW,CAAE,KAAK,CAAE;AAC3GlM,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAAD,MAAA,CAAAC,CAAA,eAAQ,MAAY;AAC9C,CAAC;;AAETD,MAAA,CAAAC,CAAA,WAAQ+L,OAAO,CAAE,IAAI,CAACtJ,KAAM,CAAC,QAAM,QAAQ,CAACxC,KAAK,CAAE,CAAC+L,KAAK,CAAE,KAAK,CAAEC,WAAW,CAAE,KAAK,CAAE;AACpFlM,MAAA,CAAAC,CAAA,MAAG,QAAM,aAAa,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAAD,MAAA,CAAAC,CAAA,eAAQ,OAAa;AAChD,CAAC;AACV,GAAC;AACFD,MAAA,CAAAC,CAAA,WAAQ,QAAM,qBAAqB,CAACkM,QAAQ,CAAEV,OAAQ,CAACO,OAAO,CAAE,IAAI,CAACpJ,SAAU;AAC7E5C,MAAA,CAAAC,CAAA,MAAG,QAAM,qBAAqB,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AACnC,CAAC;AACTD,MAAA,CAAAC,CAAA,WAAQ,QAAM,qBAAqB,CAACkM,QAAQ,CAAEV,OAAQ,CAACvL,KAAK,CAAE,CAACkM,UAAU,CAAC,KAAK,CAACjM,QAAQ,CAAC,UAAU,CAACkM,MAAM,CAAC,GAAG,CAAE,CAACL,OAAO,CAAE,IAAI,CAACnJ,QAAS;AACtI7C,MAAA,CAAAC,CAAA,MAAG,QAAM,qBAAqB,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AACnC,CAAC;AACTD,MAAA,CAAAC,CAAA,WAAQ,QAAM,oBAAoB,CAACkM,QAAQ,CAAEX,KAAM,CAACtL,KAAK,CAAE,CAACgM,WAAW,CAAC,KAAK,CAAE,CAACF,OAAO,CAAE,IAAI,CAACjJ,QAAS;AACrG/C,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AAClC,CAAC;AACTD,MAAA,CAAAC,CAAA,WAAQ,QAAM,oBAAoB,CAACkM,QAAQ,CAAEX,KAAM,CAACQ,OAAO,CAAE,IAAI,CAAClJ,QAAS;AACzE9C,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AAClC,CAAC,IAAC;AACVD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC+L,OAAO,CAAE,IAAI,CAACrE,QAAS;AAC5C3H,MAAA,CAAAC,CAAA,MAAG,QAAM,cAAc,CAAI,CAAC;AACtB;AACP,CAAC;AACJD,MAAA,CAAAC,CAAA;AACED,MAAA,CAAAC,CAAA,UAAO,QAAM,UAAU,EAAC,QAChB;AAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AACZD,MAAA,CAAAC,CAAA,WAAQiG,IAAI,CAAC,OAAO,CAAC,QAAM,QAAQ,CAACoG,QAAQ,CAAE,IAAI,CAAC3F,WAAY,CAACnC,KAAK,CAAE,IAAI,CAACnD,KAAM;AAChFrB,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,WAAW,EAAC,WAAiB,CAAC;AAC5CxE,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC;AAClCxE,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,QAAQ,EAAC,QAAc,CAAC;AACtCxE,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC;AAClCxE,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,YAAY,EAAC,aAAmB;AACxC;AACH,CAAC,IAAC;AACTxE,MAAA,CAAAC,CAAA,UAAO,QAAM,UAAU,EAAC,QAChB;AAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AACZD,MAAA,CAAAC,CAAA,WAAQiG,IAAI,CAAC,OAAO,CAAC,QAAM,QAAQ,CAACoG,QAAQ,CAAE,IAAI,CAAC/E,WAAY,CAAC/C,KAAK,CAAEmG,WAAW,CAAClD,KAAK,CAAG,KAAK,CAAG,IAAK;AACtGzH,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,IAAI,EAAC,IAAU,CAAC;AAC9BxE,MAAA,CAAAC,CAAA,WAAQuE,KAAK,CAAC,KAAK,EAAC,OAAa;AAC3B;AACH,CAAC,IAAC;AACTxE,MAAA,CAAAC,CAAA,UAAO,QAAM,UAAU,EAAC,YACZ;AAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC;AAChBD,MAAA,CAAAC,CAAA,WAAQ+L,OAAO,CAAE,IAAI,CAACnH,eAAgB,CAAC,QAAO,IAAI,CAACzD,MAAM,CAAG,QAAQ,CAAG,iBAAkB;AACrF,CAAAiK,cAAA,KAAI,CAACjK,MAAM,SAAXiK,cAAA,CAAarG,iBAAiB,EAAAsG,aAAA,CAAG,IAAI,CAACpK,MAAM,eAAXoK,aAAA,CAAanF,EAAE,CAAG,EAAAoF,aAAA,KAAI,CAACrK,MAAM,eAAXqK,aAAA,CAAatF,EAAE,GAAI,QAAQ,CAAE,GAAC;AACnFjG,MAAA,CAAAC,CAAA,MAAG,QAAM,cAAc,CAAC,aAAW,kBAAkB,CAAI;AACnD;AACH;AACN,CAAC;AACH,IAAI,CAACiB,MAAM,CAAGlB,MAAA,CAAAC,CAAA;AACbD,MAAA,CAAAC,CAAA,eAAS,IAAI,CAACiB,MAAM,CAACqL,MAAe,CAAC,KAAE,CAAC,IAAI,CAACrL,MAAM,CAAC+E,EAAE,CAAC,OAAK,CAAC,IAAI,CAAC/E,MAAM,CAACiF;AACvE,CAAC,CAAGnG,MAAA,CAAAC,CAAA;AACND,MAAA,CAAAC,CAAA,WAAI,YAAc;AAChB,CAAC;AACJ,IAAI,CAACiB,MAAM,CAAGlB,MAAA,CAAAC,CAAA;AACbD,MAAA,CAAAC,CAAA,MAAG,QAAM,QAAQ,CAACqG,IAAI,CAAC,GAAG,CAAC0F,OAAO,CAAE,IAAI,CAAC3G,aAAc,CAACnF,KAAK,CAAE,CAAC,QAAO,OAAO,CAAE;AAC9EF,MAAA,CAAAC,CAAA,MAAG,QAAM,gBAAgB,CAAC,kBAAW,CAAI,CAAC;AACzC,CAAC;AACH,IAAI,CAACiB,MAAM,CAACwE,UAAU,CAAG,GAAI,CAAAE,IAAI,CAAC,IAAI,CAAC1E,MAAM,CAACwE,UAAU,CAAG,IAAI,CAAC,CAAC8G,YAAY,CAAC,CAAC,CAAG,qBAAqB;AACvG,IAAI,CAACtL,MAAM,CAACuL,MAAM,CAAG,OAAQzM,MAAA,CAAAC,CAAA,WAAI,SAAW,CAAC,KAAM,IAAI,CAACiB,MAAM,CAACuL,MAAM,CAAG,CAAG;;AAE3E,CAAC,CAAGzM,MAAA,CAAAC,CAAA,UAAG,MAAS,CAAC;AACnB,CAACgF,QAAQ,CAAC4F,WAAW,CAAC,CAAC,EAAI7K,MAAA,CAAAC,CAAA;AAC1BD,MAAA,CAAAC,CAAA,MAAGqG,IAAI,CAAC,GAAG,CAAC,QAAM,QAAQ,EAACtG,MAAA,CAAAC,CAAA,MAAG,QAAM,kBAAkB,CAAI,CAAC,gBAAgB;AAC1E;AACA,CAAC;AACR,CAAC,CAAA4H,OAAA;AACQ9H,MAAM,CAAf,SAAAA,OAAA,CAAkB;AAChB,GAAI,IAAI,CAACmB,MAAM,GAAK,IAAI,CAAE,MAAO,KAAI,CAAC0J,cAAc,CAAC,CAAC;;AAEtD,GAAI,CAAAzK,QAAa,CAAG,CAAC,CAAC;AACtB,GAAI8E,QAAQ,CAAC4F,WAAW,CAAC,CAAC,CAAE;AAC1B,GAAI5F,QAAQ,CAACyH,WAAW,CAAE;AACxBvM,QAAQ,CAAG,CAACA,QAAQ,CAAE,QAAQ,CAAEzB,GAAG,CAAE,GAAG,CAAC;AAC3C,CAAC,IAAM;AACLyB,QAAQ,CAAG,CAACA,QAAQ,CAAE,QAAQ,CAAEwM,MAAM,CAAE,GAAG,CAAC;AAC9C;AACF;;AAEA,MAAO,CAAA3M,MAAA,CAAAC,CAAA,QAAK,QAAOgF,QAAQ,CAAC4F,WAAW,CAAC,CAAC,CAAG,qBAAqB,CAAG,SAAU,CAAC3K,KAAK,CAAEC,QAAS,EAACH,MAAA,CAAAC,CAAA,QAAKC,KAAK,CAAE,CAACC,QAAQ,CAAE,UAAU,CAAE;AACjIH,MAAA,CAAAC,CAAA,CAACV,SAAS,KAAE,CAAC;AACbS,MAAA,CAAAC,CAAA,CAACI,YAAY,KAAE,CAAC;AACf,IAAI,CAAC8K,cAAc,CAAC,CAAC;AACtBnL,MAAA,CAAAC,CAAA,QAAKzB,EAAE,CAAC,gBAAgB,CAAM;AAC3B,CAAM,CAAC;AACd,CAAC,QAAAgC,WAAA,GA7Z8BR,MAAM,CAACI,SAAS"}